{"version":3,"sources":["webpack:///webpack/bootstrap 90cd0be6cf62ee66101c","webpack:///external \"mongoose\"","webpack:///external \"lodash\"","webpack:///./src/index.js","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///external \"regenerator-runtime\"","webpack:///external \"debug\"","webpack:///external \"http\"","webpack:///external \"express\"","webpack:///external \"path\"","webpack:///external \"morgan\"","webpack:///external \"jade\"","webpack:///external \"cookie-parser\"","webpack:///external \"bluebird\"","webpack:///external \"body-parser\"","webpack:///external \"chalk\"","webpack:///./src/utils/AnalyticsWidget.js","webpack:///external \"decision-tree\"","webpack:///./models/Form.js","webpack:///./models/Element.js","webpack:///./models/User.js"],"names":["debug","require","http","express","path","logger","jade","cookieParser","bluebird","bodyParser","mongoose","chalk","_","Analytics","app","Form","Element","User","promisifyAll","Promise","global","connect","keepAlive","reconnectTries","useMongoClient","reconnectInterval","err","hex","error","console","log","green","use","json","urlencoded","extended","static","join","__dirname","set","req","res","next","header","method","send","options","post","namespace","body","elements","limit","hasOwnProperty","find","record","length","save","success","union","filter","includes","e","promises","responseData","forEach","element","p","exec","then","analyticsMethod","perSubjectRecent","val","perSubjectFrequency","decisionTree","bayesian","push","all","catch","name","email","password","username","user","runAnalytics","dataset","sortResults","data","prop","asc","sort","a","b","d","namespaces","analysis","sortedData","i","temp","result","formNamespace","elementNamespaces","elementValues","values","msg","every","indexOf","elem","records","map","value","key","references","finalRef","ele","updatedAt","Date","createdAt","collection","insert","get","remove","hasTable","hasAnd","query","hasOr","hasWhere","hasUser","hasLike","hasLimit","hasTables","$regex","$options","table","where","$all","and","$in","or","like","toFullNamespace","tables","docs","take","locals","message","status","port","blue","server","createServer","listen","onError","onListening","syscall","bind","code","process","exit","addr","address","DecisionTree","module","exports","frequency","uniques","n","compareFrequency","dt","predicted_class","predict","treeModel","toJSON","elementArray","Schema","String","Array","output","model","type"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 90cd0be6cf62ee66101c","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 1\n// module chunks = 0","const debug = require('debug')('form-analytics:server');\nconst http = require('http');\nconst express = require('express');\nconst path = require('path');\nconst logger = require('morgan');\nconst jade = require('jade');\nconst cookieParser = require('cookie-parser');\nconst bluebird = require('bluebird');\nconst bodyParser = require('body-parser');\nconst mongoose = require('mongoose');\nconst chalk = require('chalk');\nconst _ = require('lodash');\nconst Analytics = require('./utils/AnalyticsWidget.js');\n\nconst app = express();\n\n//Models\nconst Form = require('../models/Form');\nconst Element = require('../models/Element');\nconst User = require('../models/User');\n\nbluebird.promisifyAll(mongoose);\nmongoose.Promise = global.Promise;\n\n//Connect to Database\nmongoose.connect('mongodb://mongoAdmin:Innov8@34.226.210.46:27017/admin', {\n    keepAlive: true,\n    reconnectTries: 5,\n    useMongoClient: true,\n    reconnectInterval: 500\n}, (err) => {\n    if (err) {\n        chalk.hex('#e81a00')('\\u2715 Failed to Connect to AWS instance, attemping to connect to local instance');\n        mongoose.connect('mongodb://localhost/test', (error) => {\n            if (error) {\n                console.log(chalk.hex('#e81a00')('\\u2715 Failed to Connect to the Database....Check Connection URI'))\n            } else {\n                console.log(chalk.green('\\u2713 connected to MongoDB:LOCAL ENV'));\n            }\n        });\n    } else {\n        console.log(chalk.green('\\u2713 Successfully connected to MongoDB in AWS'));\n\n    }\n});\n\n// uncomment after placing your favicon in /public\napp.use(logger('dev'));\napp.use(bodyParser.json());\n\napp.use(bodyParser.urlencoded({extended: false}));\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, 'public')));\napp.set('view engine', 'jade');\n\n\n//Allow CORS\napp.use((req, res, next) => {\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\n    res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n    next();\n});\n\napp.use(function(req, res, next) {\n    res.header('Access-Control-Allow-Origin', '*');\n    res.header('Access-Control-Allow-Methods', 'GET, PUT, POST, DELETE, OPTIONS');\n    res.header('Access-Control-Allow-Headers', 'Content-Type, Authorization, Content-Length, X-Requested-With');\n    //intercepts OPTIONS method\n    'OPTIONS' === req.method ? res.send(200) : next();\n});\n\napp.options(\"/*\", function(req, res, next){\n    res.header('Access-Control-Allow-Origin', '*');\n    res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE,OPTIONS');\n    res.header('Access-Control-Allow-Headers', 'Content-Type, Authorization, Content-Length, X-Requested-With');\n    res.send(200);\n});\n\n\n/**\n * Handles registering a new Namespace (for a new form)\n * or Running Analytics on an existing namespace\n */\napp.post('/form/register', async (req, res) => {\n    //Get the namespace & Required variables i.e. ApplicationName.formName\n    const namespace = req.body.namespace;\n    const elements = req.body.elements;\n    const method = req.body.method;\n    let limit;\n\n    if(req.body.hasOwnProperty('limit')) {\n         limit = req.body.limit;\n    }\n\n    Form.find({namespace}, (err, record) => {\n        //There was no namespace this is a new form\n        if(record.length <= 0) {\n            //Create a new namespace\n            new Form({namespace, elements}).save((err, record) => {\n                console.log(chalk.green(`\\u2713 Successfully created new Namespace: ${namespace}`));\n\n                res.json({\n                    success:true,\n                    namespace\n                })\n            });\n\n        } else {\n\n            //Find the different element & Join them into the Form Namespace\n            record[0].set({elements: _.union(elements.filter(e => !record[0].elements.includes(e)), record[0].elements)});\n            record[0].save();\n\n            console.log(chalk.green(`\\u2713 Namespace: ${namespace} has been located running analytics...`));\n\n            let promises = [];\n            let responseData = [];\n\n            elements.forEach(element => {\n                console.log(chalk.green(`\\u2713 Found Data for Element Namespace: ${element}`));\n                //Find each element given its parent namespace\n                let p = Element.find({namespace: `${namespace}.${element}`}).exec().then(val => {\n                    //Acts as a switch statement to effectively compute based on the specified method\n                    let analyticsMethod = {\n                        'per-subject-recent': () => {\n                            return  Analytics.perSubjectRecent(val, limit);\n                        },\n                        'per-subject-frequency': () => {\n                            return Analytics.perSubjectFrequency(val, limit);\n                        },\n                        'decision-tree': () => {\n                            return Analytics.decisionTree(val, limit);\n                        },\n                        'bayesian': () => {\n                            return Analytics.bayesian(val, limit);\n                        }\n                    };\n                    //Push the results of the analytics to an empty array\n                    responseData.push(analyticsMethod[method]());\n                });\n                promises.push(p);\n            });\n            Promise.all(promises).then(() => {\n                res.json(responseData);\n            }).catch((err) => {\n                console.error(err);\n            });\n        }\n    });\n});\n\n/**\n * Handles a basic user signup\n */\napp.post('/signup', async (req, res) => {\n    let {name, email, password, username }  = req.body;\n\n    let user = new User({name, email, password, username});\n    user.save();\n\n    res.json({success:true, user});\n});\n\n/**\n * Handles Calculating the Analytics on a custom dataset\n * @param dataset Array of MongoDB document objects\n\n * @param method String Method of analytics to run i.e. \"per-subject-frequency\n */\nconst runAnalytics = async (dataset, method, limit = 3) => {\n\n    let analyticsMethod = {\n        'per-subject-recent': () => {\n            return  Analytics.perSubjectRecent(dataset, limit);\n        },\n        'per-subject-frequency': () => {\n            return Analytics.perSubjectFrequency(dataset, limit);\n        },\n        'decision-tree': () => {\n            return Analytics.decisionTree(dataset, limit);\n        },\n        'bayesian': () => {\n            return Analytics.bayesian(dataset, limit);\n        }\n    };\n\n    //Push the results of the analytics to an empty array\n    return analyticsMethod[method]();\n};\n\n/**\n * Sorts JSON by specified object property\n * @param data Array JSON data to sort\n * @param prop String Object property name to sort by\n * @param asc boolean True to sort in ascending order\n * @returns {Aggregate|Query|*|Array.<T>}\n */\nconst sortResults = (data, prop, asc) => {\n    data = data.sort((a, b) => {\n        if (asc) {\n            return (a[prop] > b[prop]) ? 1 : ((a[prop] < b[prop]) ? -1 : 0);\n        } else {\n            return (b[prop] > a[prop]) ? 1 : ((b[prop] < a[prop]) ? -1 : 0);\n        }\n    });\n\n    return data;\n};\n\n/**\n * Handles Running Analytics on a Custom Set of Data\n * This method will do 3 things\n * 1.) Find all unique namespaces in the input data set\n * 2.) For each unique namespace run the specified analytics method on all of the data in that namespace\n * 3.) return an array with X amount of nested arrays representing the analysis for each unique namespace\n */\napp.post('/analytics', async (req, res) => {\n    const data = req.body.data;\n    const method = req.body.method;\n    let limit;\n\n    if(req.body.hasOwnProperty('limit')) {\n        limit = req.body.limit;\n    }\n\n\n    data.forEach(d => {\n       if(d.namespace === 'Pizza.createForm.Veggies') {\n           console.log(d);\n       }\n    });\n\n    let namespaces = []; //Array holding all unique namespace\n    let analysis = []; //Array holding analysis for each unique namespace\n\n    let sortedData = sortResults(data, 'namespace', true);\n\n    for(let i = 0; i < sortedData.length; i++) {\n        if(!_.includes(namespaces, sortedData[i].namespace)) {\n            namespaces.push(sortedData[i].namespace)\n        }\n    }\n\n    //Filter the data and run the analytics\n    namespaces.forEach(namespace => {\n        let temp = [];\n\n        //TODO for some reason filter produces inconsistent results...weird..gonna have to filter manually for now\n       data.forEach(d => {\n          if(d.namespace === namespace) {\n              temp.push(d);\n          }\n       });\n\n       analysis.push(runAnalytics(temp, method, limit));\n    });\n\n    Promise.all(analysis).then(result => {\n        res.json(result);\n    }).catch((err) => {\n        console.error(err);\n    });\n\n});\n\n\n/**\n * Handles Inserting data into Mongo but does not run analytics\n * this is how the classifier is updated when the Submit button is pressed\n */\napp.post('/insert', async  (req, res) => {\n    const formNamespace = req.body.namespace; //Pizza.createForm\n    const elementNamespaces = req.body.elements; //[Meat, Veggies, CrustStyle]\n    const elementValues = req.body.values; //[Pepperoni, Tomatoes, Thin]\n    let user = req.body.user; //UserID\n\n    if(typeof user === 'undefined') {\n        user = null\n    }\n\n    if(elementNamespaces.length !== elementValues.length) {\n        console.log(chalk.hex('#e81a00')('\\u2715 ElementOutOfBoundsException Error: More Elements than Values to fill.'));\n        res.json({success: false, msg: 'There were more namespaces than values to fill or vice versa....Please ensure both arrays are of the same length.'});\n    } else {\n\n        //Ensure the elements exist in the Form Namespace\n        Form.find({namespace: formNamespace}, (err, record) => {\n            if (typeof record !== \"undefined\" && record.length > 0) {\n                if (!elementNamespaces.every(elem => record[0].elements.indexOf(elem) > -1)) {\n\n                    //An elementNamespace is not already defined in the Form model\n                    console.log(chalk.hex('#e81a00')('\\u2715 UndefinedNamespaceException: One of the element namespaces has not yet been defined in the Form Model'));\n                    res.json({\n                        success: false,\n                        msg: 'UndefinedNamespaceException: One of the element namespaces has not yet been defined in the Form Model'\n                    })\n\n                } else {\n                    let records = [];\n\n                    //Add a new value for each namespace\n                    elementNamespaces.map((value, key) => {\n                        //Remove the Item being stored from referencing itself\n                        let references = elementValues.filter(e => e !== elementValues[key]);\n                        let namespaces = elementNamespaces.filter(e => e !== elementNamespaces[key]);\n\n                        //Map over each reference and convert it into an object\n                        let finalRef = references.map((ele, key) => {\n                            return {\n                                namespace: `${formNamespace}.${namespaces[key]}`,\n                                value: ele\n                            }\n                        });\n\n                        records.push(new Element({\n                            namespace: `${formNamespace}.${value}`,\n                            value: elementValues[key],\n                            user,\n                            references: finalRef,\n                            updatedAt: new Date(),\n                            createdAt: new Date()\n                        }));\n                    });\n\n                    //Insert Bulk operation\n                    Element.collection.insert(records, (err, data) => {\n                        if(err) res.json({success: false, err});\n                        console.log(chalk.green(`\\u2713 Element data saved!`));\n                        res.json({success: true});\n                    });\n                }\n            } else {\n                console.log(chalk.hex('#e81a00')('\\u2715 UndefinedNamespaceException: One of the Form namespaces has not yet been defined in the Form Model use /form/register to define a new namespace'));\n                res.json({\n                    success: false,\n                    msg: 'UndefinedNamespaceException: One of the Form namespaces has not yet been defined in the Form Model use /form/register to define a new namespace'\n                })\n            }\n        });\n    }\n});\n\n/**\n * Deletes all records in a Collection\n */\napp.get('/remove', (req, res) => {\n    Form.remove({}, () => {});\n    Element.remove({}, () => {});\n    res.json({success: true});\n});\n\napp.get('/all', (req, res) => {\n    Form.find({namespace: \"Pizza.createForm\"}, (err, data) => {\n        console.log(data);\n    });\n\n    Element.find({}, (err, d) => {\n        res.json(d);\n    });\n});\n\napp.post('/query', async (req, res) => {\n    try {\n        var hasTable = req.body.hasOwnProperty('table');\n        var hasAnd = req.body.query.hasOwnProperty('and');\n        var hasOr = req.body.query.hasOwnProperty('or');\n        var hasWhere = req.body.query.hasOwnProperty('where');\n        var hasUser = req.body.query.hasOwnProperty('user');\n        var hasLike = req.body.query.hasOwnProperty('like');\n        var hasLimit = req.body.query.hasOwnProperty('limit');\n        var hasTables = req.body.hasOwnProperty('tables')\n    } catch (err) {\n        //They are missing some properties of the query\n        console.log('\\u2715 Part of the Query is Undefined');\n    }\n\n    //Basic Error Checking\n    if(hasAnd && hasOr) {\n        res.json({\n            error: true,\n            msg: 'At this time you must either have an \"and\" property or an \"or\" property but not both.'\n        })\n    }\n\n    if(hasLike && hasWhere) {\n        res.json({\n            error: true,\n            msg: 'At this time you must either have a \"where\" clause or a \"like\" clause but not both'\n        })\n    }\n\n    if(hasTable && hasTables) {\n        res.json({\n            error: true,\n            msg: 'At this time you must either have a \"table\" clause or a \"tables\" clause but not both'\n        })\n    }\n\n    //Build up the query from an empty object\n    let query = {};\n\n    //Match Req body to query values\n    !hasTable ? query.namespace = {\n        $regex: req.body.namespace,\n        $options: 'i'\n    } : query.namespace = `${req.body.namespace}.${req.body.table}`;\n    hasWhere ? query.value = req.body.query.where : null;\n    hasAnd ? query['references.value'] = {$all: req.body.query.and} : null;\n    hasOr ? query['references.value'] = {$in: req.body.query.or} : null;\n    hasUser ? query.user = req.body.query.user : null;\n    hasLike ? query.value = {$regex: '.*' + req.body.query.like + '.*', $options: 'i'} : null;\n    if(hasTables) {\n        query.namespace = Analytics.toFullNamespace(req.body.namespace, req.body.tables);\n    }\n    hasLimit ?\n        Element.find(query, (err, docs) => {\n            docs = _.take(docs, req.body.limit);\n            res.json(docs);\n        }) :\n        Element.find(query, (err, docs) => {\n           res.json(docs);\n        });\n});\n\napp.get('*', async (req, res) => {\n    res.json({success: true, msg: 'The server is active and running!'});\n});\n\n// error handler\napp.use((err, req, res) => {\n    console.log(err);\n    // set locals, only providing error in development\n    res.locals.message = err.message;\n    res.locals.error = req.app.get('env') === 'development' ? err : {};\n\n    // render the error page\n    res.status(err.status || 500);\n\n    res.json({error: err});\n\n});\n\n\n/**\n * Get port from environment and store in Express.\n */\n\nconst port = 3010;\nconsole.log(chalk.blue('\\u2713 Setting Server Port to 3010...'));\napp.set('port', port);\n\n/**\n * Create HTTP server.\n */\nconsole.log(chalk.blue('\\u2713 Creating HTTP Server...'));\nconst server = http.createServer(app);\n\n/**\n * Listen on provided port, on all network interfaces.\n */\n\nserver.listen(port, (err) => {\n    if(err) onError(err);\n    onListening();\n});\n\n/**\n * Event listener for HTTP server \"error\" event.\n */\n\nfunction onError(error) {\n    if (error.syscall !== 'listen') {\n        throw error;\n    }\n\n    let bind = typeof port === 'string'\n        ? 'Pipe ' + port\n        : 'Port ' + port;\n\n    // handle specific listen errors with friendly messages\n    switch (error.code) {\n        case 'EACCES':\n            console.error(bind + ' requires elevated privileges');\n            process.exit(1);\n            break;\n        case 'EADDRINUSE':\n            console.error(bind + ' is already in use');\n            process.exit(1);\n            break;\n        default:\n            throw error;\n    }\n}\n\n/**\n * Event listener for HTTP server \"listening\" event.\n */\nfunction onListening() {\n    let addr = server.address();\n    console.log(chalk.green('\\u2713 Running version (1.0.0)'));\n    console.log(chalk.blue('-------------------------------------------'));\n    console.log(chalk.blue(`| Analytics Server Listening on Port ${addr.port} |`));\n    console.log(chalk.blue('-------------------------------------------'));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 4\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"debug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"debug\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"jade\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jade\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"bluebird\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bluebird\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"chalk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"chalk\"\n// module id = 15\n// module chunks = 0","const _ = require('lodash');\nconst DecisionTree = require('decision-tree');\n\nmodule.exports = {\n    /**\n     * Takes the Rightmost 3 Elements from the\n     * Mongoose document array as the most recently used pieces of form data\n     * @param data\n     * @param limit int Limit the analysis results being returned\n     * @returns {Array}\n     */\n    perSubjectRecent(data, limit = 3) {\n        return _.take(data, limit);\n    },\n\n    /**\n     * Find the most frequently used\n     * @param data\n     * @param limit int Limit the analysis results being returned\n     */\n    perSubjectFrequency(data, limit = 3) {\n        var frequency = {}, value;\n\n        // compute frequencies of each value\n        for(var i = 0; i < data.length; i++) {\n            value = data[i].value;\n            if(value in frequency) {\n                frequency[value]++;\n            } else {\n                frequency[value] = 1;\n            }\n        }\n\n        // make array from the frequency object to de-duplicate\n        var uniques = [];\n        for(value in frequency) {\n            uniques.push(value);\n        }\n\n        //Remove any blank values\n        uniques = uniques.filter(function(n){ return n != '' });\n\n        // sort the uniques array in descending order by frequency\n        function compareFrequency(a, b) {\n            return frequency[b] - frequency[a];\n        }\n        uniques.sort(compareFrequency);\n        \n        return _.take(uniques, limit);\n    },\n\n    /**\n     *\n     * @param data\n     * @param limit int Limit the analysis results being returned\n     * @returns {*}\n     */\n    decisionTree(data, limit = 3) {\n        let dt = new DecisionTree(data, \"value\", [\"value\", \"namespace\"]);\n\n        let predicted_class = dt.predict({\n            value: \"Ham\",\n            namespace: \"Pizza.createForm.Meats\"\n        });\n\n        let treeModel = dt.toJSON();\n        return predicted_class;\n\n    },\n\n    /**\n     *\n     * @param data\n     * @param limit int Limit the analysis results being returned\n     * @returns {*}\n     */\n    bayesian(data, limit = 3) {\n        //TODO mutate data\n        return data;\n    },\n\n    /**\n     * Takes a Parent Form Namespace and an array of elements which belong to the form\n     * and returns an array of fully quantified Namespaces ready for querying\n     * @param formNamespace\n     * @param elementArray\n     */\n    toFullNamespace(formNamespace, elementArray) {\n        return elementArray.map(value => {\n            return `${formNamespace}.${value}`\n        });\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/utils/AnalyticsWidget.js","module.exports = require(\"decision-tree\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"decision-tree\"\n// module id = 17\n// module chunks = 0","/**\n * Created by christianbartram on 10/18/17.\n */\nconst mongoose = require('mongoose');\n\nlet Form = mongoose.Schema({\n    namespace: String,\n    elements: Array,\n    output: String,\n    method: String\n});\n\n/**\n * Schema Methods\n */\n\n//Export the Model\nmodule.exports = mongoose.model('Form', Form);\n\n\n// WEBPACK FOOTER //\n// ./models/Form.js","/**\n * Created by christianbartram on 10/18/17.\n */\nconst mongoose = require('mongoose');\n\nlet Element = mongoose.Schema({\n    namespace: String, //Element on the forms specific namespace/id\n    type: String, //Select field, radio button, checkbox etc...\n    value: String,\n    user: String,\n    references: Array,\n    updatedAt: Date,\n    createdAt: Date\n});\n\n/**\n * Schema Methods\n */\n\n//Export the Model\nmodule.exports = mongoose.model('Element', Element);\n\n\n// WEBPACK FOOTER //\n// ./models/Element.js","/**\n * Created by christianbartram on 10/18/17.\n */\nconst mongoose = require('mongoose');\n\n\nlet User = mongoose.Schema({\n  name: String,\n  username: String,\n  email: String,\n  password: String\n});\n\n/**\n * Schema Methods\n */\n\n//Export the Model\nmodule.exports = mongoose.model('User', User);\n\n\n// WEBPACK FOOTER //\n// ./models/User.js"],"sourceRoot":""}