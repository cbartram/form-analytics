{"version":3,"sources":["webpack:///webpack/bootstrap afc30a85b45473df6772","webpack:///external \"mongoose\"","webpack:///external \"lodash\"","webpack:///./src/index.js","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///external \"regenerator-runtime\"","webpack:///external \"debug\"","webpack:///external \"http\"","webpack:///external \"express\"","webpack:///external \"path\"","webpack:///external \"morgan\"","webpack:///external \"jade\"","webpack:///external \"cookie-parser\"","webpack:///external \"bluebird\"","webpack:///external \"body-parser\"","webpack:///external \"chalk\"","webpack:///./src/utils/AnalyticsWidget.js","webpack:///external \"decision-tree\"","webpack:///./models/Form.js","webpack:///./models/Element.js","webpack:///./models/User.js"],"names":["debug","require","http","express","path","logger","jade","cookieParser","bluebird","bodyParser","mongoose","chalk","_","Analytics","app","Form","Element","User","promisifyAll","Promise","global","connect","keepAlive","reconnectTries","useMongoClient","reconnectInterval","err","hex","error","console","log","green","use","json","urlencoded","extended","static","join","__dirname","set","req","res","next","header","method","send","options","post","namespace","body","elements","limit","hasOwnProperty","MAX_INTEGER","find","record","length","save","success","union","filter","includes","e","promises","responseData","forEach","element","p","exec","then","analyticsMethod","perSubjectRecent","val","perSubjectFrequency","decisionTree","bayesian","push","all","catch","name","email","password","username","user","runAnalytics","dataset","data","formNamespace","elementNamespaces","elementValues","values","msg","every","indexOf","elem","records","map","value","key","references","namespaces","finalRef","ele","updatedAt","Date","createdAt","collection","insert","get","remove","d","hasTable","hasAnd","query","hasOr","hasWhere","hasUser","hasLike","hasLimit","table","t","where","$all","and","$in","or","$regex","like","$options","sort","docs","locals","message","status","port","blue","server","createServer","listen","onError","onListening","syscall","bind","code","process","exit","addr","address","DecisionTree","module","exports","take","frequency","i","uniques","n","compareFrequency","a","b","dt","predicted_class","predict","treeModel","toJSON","toFullNamespace","elementArray","Schema","String","Array","output","model","type"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap afc30a85b45473df6772","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 1\n// module chunks = 0","const debug = require('debug')('form-analytics:server');\nconst http = require('http');\nconst express = require('express');\nconst path = require('path');\nconst logger = require('morgan');\nconst jade = require('jade');\nconst cookieParser = require('cookie-parser');\nconst bluebird = require('bluebird');\nconst bodyParser = require('body-parser');\nconst mongoose = require('mongoose');\nconst chalk = require('chalk');\nconst _ = require('lodash');\nconst Analytics = require('./utils/AnalyticsWidget.js');\n\nconst app = express();\n\n//Models\nconst Form = require('../models/Form');\nconst Element = require('../models/Element');\nconst User = require('../models/User');\n\nbluebird.promisifyAll(mongoose);\nmongoose.Promise = global.Promise;\n\n//Connect to Database\nmongoose.connect('mongodb://mongoAdmin:Innov8@34.226.210.46:27017/admin', {\n    keepAlive: true,\n    reconnectTries: 5,\n    useMongoClient: true,\n    reconnectInterval: 500\n}, (err) => {\n    if (err) {\n        chalk.hex('#e81a00')('\\u2715 Failed to Connect to AWS instance, attemping to connect to local instance');\n        mongoose.connect('mongodb://localhost/test', (error) => {\n            if (error) {\n                console.log(chalk.hex('#e81a00')('\\u2715 Failed to Connect to the Database....Check Connection URI'))\n            } else {\n                console.log(chalk.green('\\u2713 connected to MongoDB:LOCAL ENV'));\n            }\n        });\n    } else {\n        console.log(chalk.green('\\u2713 Successfully connected to MongoDB in AWS'));\n\n    }\n});\n\n// uncomment after placing your favicon in /public\napp.use(logger('dev'));\napp.use(bodyParser.json());\n\napp.use(bodyParser.urlencoded({extended: false}));\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, 'public')));\napp.set('view engine', 'jade');\n\n\n//Allow CORS\napp.use((req, res, next) => {\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\n    res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n    next();\n});\n\napp.use(function(req, res, next) {\n    res.header('Access-Control-Allow-Origin', '*');\n    res.header('Access-Control-Allow-Methods', 'GET, PUT, POST, DELETE, OPTIONS');\n    res.header('Access-Control-Allow-Headers', 'Content-Type, Authorization, Content-Length, X-Requested-With');\n    //intercepts OPTIONS method\n    'OPTIONS' === req.method ? res.send(200) : next();\n});\n\napp.options(\"/*\", function(req, res, next){\n    res.header('Access-Control-Allow-Origin', '*');\n    res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE,OPTIONS');\n    res.header('Access-Control-Allow-Headers', 'Content-Type, Authorization, Content-Length, X-Requested-With');\n    res.send(200);\n});\n\n\n/**\n * Handles registering a new Namespace (for a new form)\n * or Running Analytics on an existing namespace\n */\napp.post('/form/register', async (req, res) => {\n    //Get the namespace & Required variables i.e. ApplicationName.formName\n    const namespace = req.body.namespace;\n    const elements = req.body.elements;\n    const method = req.body.method;\n    let limit;\n\n    if(req.body.hasOwnProperty('limit')) {\n         limit = req.body.limit;\n    } else {\n         limit = MAX_INTEGER;\n    }\n\n    Form.find({namespace}, (err, record) => {\n        //There was no namespace this is a new form\n        if(record.length <= 0) {\n            //Create a new namespace\n            new Form({namespace, elements}).save((err, record) => {\n                console.log(chalk.green(`\\u2713 Successfully created new Namespace: ${namespace}`));\n\n                res.json({\n                    success:true,\n                    namespace\n                })\n            });\n\n        } else {\n\n            //Find the different element & Join them into the Form Namespace\n            record[0].set({elements: _.union(elements.filter(e => !record[0].elements.includes(e)), record[0].elements)});\n            record[0].save();\n\n\n            console.log(chalk.green(`\\u2713 Namespace: ${namespace} has been located running analytics...`));\n\n            let promises = [];\n            let responseData = [];\n\n            elements.forEach(element => {\n                console.log(chalk.green(`\\u2713 Found Data for Element Namespace: ${element}`));\n                //Find each element given its parent namespace\n                let p = Element.find({namespace: `${namespace}.${element}`}).exec().then(val => {\n                    //Acts as a switch statement to effectively compute based on the specified method\n                    let analyticsMethod = {\n                        'per-subject-recent': () => {\n                            return  Analytics.perSubjectRecent(val, limit);\n                        },\n                        'per-subject-frequency': () => {\n                            return Analytics.perSubjectFrequency(val, limit);\n                        },\n                        'decision-tree': () => {\n                            return Analytics.decisionTree(val, limit);\n                        },\n                        'bayesian': () => {\n                            return Analytics.bayesian(val, limit);\n                        }\n                    };\n                    //Push the results of the analytics to an empty array\n                    responseData.push(analyticsMethod[method]());\n                });\n                promises.push(p);\n            });\n            Promise.all(promises).then(() => {\n                res.json(responseData);\n            }).catch((err) => {\n                console.error(err);\n            });\n        }\n    });\n});\n\n/**\n * Handles a basic user signup\n */\napp.post('/signup', async (req, res) => {\n    let {name, email, password, username }  = req.body;\n\n    let user = new User({name, email, password, username});\n    user.save();\n\n    res.json({success:true, user});\n});\n\n/**\n * Handles Calculating the Analytics on a custom dataset\n * @param dataset Array of MongoDB document objects\n\n * @param method String Method of analytics to run i.e. \"per-subject-frequency\n */\nconst runAnalytics = async (dataset, method) => {\n\n    let analyticsMethod = {\n        'per-subject-recent': () => {\n            return  Analytics.perSubjectRecent(dataset);\n        },\n        'per-subject-frequency': () => {\n            return Analytics.perSubjectFrequency(dataset);\n        },\n        'decision-tree': () => {\n            return Analytics.decisionTree(dataset);\n        },\n        'bayesian': () => {\n            return Analytics.bayesian(dataset);\n        }\n    };\n\n    //Push the results of the analytics to an empty array\n    return analyticsMethod[method]();\n};\n\n/**\n * Handles Running Analytics on a Custom Set of Data\n */\napp.post('/analytics', async (req, res) => {\n    const data = req.body.data;\n    const method = req.body.method;\n\n    res.json({data: runAnalytics(data, method)});\n\n});\n\n\n/**\n * Handles Inserting data into Mongo but does not run analytics\n * this is how the classifier is updated when the Submit button is pressed\n */\napp.post('/insert', async  (req, res) => {\n    const formNamespace = req.body.namespace; //Pizza.createForm\n    const elementNamespaces = req.body.elements; //[Meat, Veggies, CrustStyle]\n    const elementValues = req.body.values; //[Pepperoni, Tomatoes, Thin]\n    let user = req.body.user; //UserID\n\n    if(typeof user === 'undefined') {\n        user = null\n    }\n\n    if(elementNamespaces.length !== elementValues.length) {\n        console.log(chalk.hex('#e81a00')('\\u2715 ElementOutOfBoundsException Error: More Elements than Values to fill.'));\n        res.json({success: false, msg: 'There were more namespaces than values to fill or vice versa....Please ensure both arrays are of the same length.'});\n    } else {\n\n        //Ensure the elements exist in the Form Namespace\n        Form.find({namespace: formNamespace}, (err, record) => {\n            if (typeof record !== \"undefined\" && record.length > 0) {\n                if (!elementNamespaces.every(elem => record[0].elements.indexOf(elem) > -1)) {\n\n                    //An elementNamespace is not already defined in the Form model\n                    console.log(chalk.hex('#e81a00')('\\u2715 UndefinedNamespaceException: One of the element namespaces has not yet been defined in the Form Model'));\n                    res.json({\n                        success: false,\n                        msg: 'UndefinedNamespaceException: One of the element namespaces has not yet been defined in the Form Model'\n                    })\n\n                } else {\n                    let records = [];\n\n                    //Add a new value for each namespace\n                    elementNamespaces.map((value, key) => {\n                        //Remove the Item being stored from referencing itself\n                        let references = elementValues.filter(e => e !== elementValues[key]);\n                        let namespaces = elementNamespaces.filter(e => e !== elementNamespaces[key]);\n\n                        //Map over each reference and convert it into an object\n                        let finalRef = references.map((ele, key) => {\n                            return {\n                                namespace: `${formNamespace}.${namespaces[key]}`,\n                                value: ele\n                            }\n                        });\n\n                        records.push(new Element({\n                            namespace: `${formNamespace}.${value}`,\n                            value: elementValues[key],\n                            user,\n                            references: finalRef,\n                            updatedAt: new Date(),\n                            createdAt: new Date()\n                        }));\n                    });\n\n                    //Insert Bulk operation\n                    Element.collection.insert(records, (err, data) => {\n                        if(err) res.json({success: false, err});\n                        console.log(chalk.green(`\\u2713 Element data saved!`));\n                        res.json({success: true});\n                    });\n                }\n            } else {\n                console.log(chalk.hex('#e81a00')('\\u2715 UndefinedNamespaceException: One of the Form namespaces has not yet been defined in the Form Model use /form/register to define a new namespace'));\n                res.json({\n                    success: false,\n                    msg: 'UndefinedNamespaceException: One of the Form namespaces has not yet been defined in the Form Model use /form/register to define a new namespace'\n                })\n            }\n        });\n    }\n});\n\n/**\n * Deletes all records in a Collection\n */\napp.get('/remove', (req, res) => {\n    Form.remove({}, () => {});\n    Element.remove({}, () => {});\n    res.json({success: true});\n});\n\napp.get('/all', (req, res) => {\n    Form.find({namespace: \"Pizza.createForm\"}, (err, data) => {\n        console.log(data);\n    });\n\n    Element.find({}, (err, d) => {\n        res.json(d);\n    });\n});\n\napp.post('/query', async (req, res) => {\n    try {\n        var hasTable = req.body.hasOwnProperty('table');\n        var hasAnd = req.body.query.hasOwnProperty('and');\n        var hasOr = req.body.query.hasOwnProperty('or');\n        var hasWhere = req.body.query.hasOwnProperty('where');\n        var hasUser = req.body.query.hasOwnProperty('user');\n        var hasLike = req.body.query.hasOwnProperty('like');\n        var hasLimit = req.body.query.hasOwnProperty('limit');\n    } catch (err) {\n        //They are missing some properties of the query\n        console.log('\\u2715 Part of the Query is Undefined');\n    }\n\n    //Basic Error Checking\n    if(hasAnd && hasOr) {\n        res.json({\n            error: true,\n            msg: 'At this time you must either have an \"and\" property or an \"or\" property but not both.'\n        })\n    }\n\n    if(hasLike && hasWhere) {\n        res.json({\n            error: true,\n            msg: 'At this time you must either have a \"where\" clause or a \"like\" clause but not both'\n        })\n    }\n\n    //Build up the query from an empty object\n    let query = {};\n\n    if(typeof req.body.table === 'object') {\n        req.body.table.forEach(t => {\n            query.namespace = `${req.body.namespace}.${req.body.t}`;\n            hasWhere ? query.value = req.body.query.where : null;\n            hasAnd ? query['references.value'] = {$all: req.body.query.and} : null;\n            hasOr ? query['references.value'] = {$in: req.body.query.or} : null;\n            hasUser ? query.user = req.body.query.user : null;\n            hasLike ? query.value = {$regex: '.*' + req.body.query.like + '.*', $options: 'i'} : null;\n        });\n\n        hasLimit ?\n            await Element.find(query).sort({'value': -1}).limit(req.body.query.limit).exec((err, docs) => res.json(docs)) :\n            Element.find(query, (err, docs) => {\n                res.json(docs);\n            });\n\n    }\n\n    //Match Req body to query values\n    !hasTable ? query.namespace = {\n        $regex: req.body.namespace,\n        $options: 'i'\n    } : query.namespace = `${req.body.namespace}.${req.body.table}`;\n    hasWhere ? query.value = req.body.query.where : null;\n    hasAnd ? query['references.value'] = {$all: req.body.query.and} : null;\n    hasOr ? query['references.value'] = {$in: req.body.query.or} : null;\n    hasUser ? query.user = req.body.query.user : null;\n    hasLike ? query.value = {$regex: '.*' + req.body.query.like + '.*', $options: 'i'} : null;\n\n    hasLimit ?\n        Element.find(query).sort({'value': -1}).limit(req.body.query.limit).exec((err, docs) => res.json(docs)) :\n        Element.find(query, (err, docs) => {\n            res.json(docs);\n        });\n\n});\n\napp.get('*', async (req, res) => {\n    res.json({success: true, msg: 'The server is active and running!'});\n});\n\n// error handler\napp.use((err, req, res) => {\n    console.log(err);\n    // set locals, only providing error in development\n    res.locals.message = err.message;\n    res.locals.error = req.app.get('env') === 'development' ? err : {};\n\n    // render the error page\n    res.status(err.status || 500);\n\n    res.json({error: err});\n\n});\n\n\n/**\n * Get port from environment and store in Express.\n */\n\nconst port = 3010;\nconsole.log(chalk.blue('\\u2713 Setting Server Port to 3010...'));\napp.set('port', port);\n\n/**\n * Create HTTP server.\n */\nconsole.log(chalk.blue('\\u2713 Creating HTTP Server...'));\nconst server = http.createServer(app);\n\n/**\n * Listen on provided port, on all network interfaces.\n */\n\nserver.listen(port, (err) => {\n    if(err) onError(err);\n    onListening();\n});\n\n/**\n * Event listener for HTTP server \"error\" event.\n */\n\nfunction onError(error) {\n    if (error.syscall !== 'listen') {\n        throw error;\n    }\n\n    let bind = typeof port === 'string'\n        ? 'Pipe ' + port\n        : 'Port ' + port;\n\n    // handle specific listen errors with friendly messages\n    switch (error.code) {\n        case 'EACCES':\n            console.error(bind + ' requires elevated privileges');\n            process.exit(1);\n            break;\n        case 'EADDRINUSE':\n            console.error(bind + ' is already in use');\n            process.exit(1);\n            break;\n        default:\n            throw error;\n    }\n}\n\n/**\n * Event listener for HTTP server \"listening\" event.\n */\nfunction onListening() {\n    let addr = server.address();\n    console.log(chalk.blue('-------------------------------------------'));\n    console.log(chalk.blue(`| Analytics Server Listening on Port ${addr.port} |`));\n    console.log(chalk.blue('-------------------------------------------'));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 4\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"debug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"debug\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"jade\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jade\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"bluebird\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bluebird\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"chalk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"chalk\"\n// module id = 15\n// module chunks = 0","const _ = require('lodash');\nconst DecisionTree = require('decision-tree');\n\nmodule.exports = {\n    /**\n     * Takes the Rightmost 3 Elements from the\n     * Mongoose document array as the most recently used pieces of form data\n     * @param data\n     * @returns {Array}\n     */\n    perSubjectRecent(data, limit) {\n        return _.take(data, limit);\n    },\n\n    /**\n     * Find the most frequently used\n     * @param data\n     */\n    perSubjectFrequency(data, limit) {\n        var frequency = {}, value;\n\n        // compute frequencies of each value\n        for(var i = 0; i < data.length; i++) {\n            value = data[i].value;\n            if(value in frequency) {\n                frequency[value]++;\n            } else {\n                frequency[value] = 1;\n            }\n        }\n\n        // make array from the frequency object to de-duplicate\n        var uniques = [];\n        for(value in frequency) {\n            uniques.push(value);\n        }\n\n        //Remove any blank values\n        uniques = uniques.filter(function(n){ return n != '' });\n\n        // sort the uniques array in descending order by frequency\n        function compareFrequency(a, b) {\n            return frequency[b] - frequency[a];\n        }\n        uniques.sort(compareFrequency);\n        \n        return _.take(uniques, limit);\n    },\n\n    decisionTree(data, limit) {\n        let dt = new DecisionTree(data, \"value\", [\"value\", \"namespace\"]);\n\n        let predicted_class = dt.predict({\n            value: \"Ham\",\n            namespace: \"Pizza.createForm.Meats\"\n        });\n\n        let treeModel = dt.toJSON();\n        return predicted_class;\n\n    },\n\n    bayesian(data, limit) {\n        //TODO mutate data\n        return data;\n    },\n\n    /**\n     * Takes a Parent Form Namespace and an array of elements which belong to the form\n     * and returns an array of fully quantified Namespaces ready for querying\n     * @param formNamespace\n     * @param elementArray\n     */\n    toFullNamespace(formNamespace, elementArray) {\n        return elementArray.map(value => {\n            return `${formNamespace}.${value}`\n        });\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/utils/AnalyticsWidget.js","module.exports = require(\"decision-tree\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"decision-tree\"\n// module id = 17\n// module chunks = 0","/**\n * Created by christianbartram on 10/18/17.\n */\nconst mongoose = require('mongoose');\n\nlet Form = mongoose.Schema({\n    namespace: String,\n    elements: Array,\n    output: String,\n    method: String\n});\n\n/**\n * Schema Methods\n */\n\n//Export the Model\nmodule.exports = mongoose.model('Form', Form);\n\n\n// WEBPACK FOOTER //\n// ./models/Form.js","/**\n * Created by christianbartram on 10/18/17.\n */\nconst mongoose = require('mongoose');\n\nlet Element = mongoose.Schema({\n    namespace: String, //Element on the forms specific namespace/id\n    type: String, //Select field, radio button, checkbox etc...\n    value: String,\n    user: String,\n    references: Array,\n    updatedAt: Date,\n    createdAt: Date\n});\n\n/**\n * Schema Methods\n */\n\n//Export the Model\nmodule.exports = mongoose.model('Element', Element);\n\n\n// WEBPACK FOOTER //\n// ./models/Element.js","/**\n * Created by christianbartram on 10/18/17.\n */\nconst mongoose = require('mongoose');\n\n\nlet User = mongoose.Schema({\n  name: String,\n  username: String,\n  email: String,\n  password: String\n});\n\n/**\n * Schema Methods\n */\n\n//Export the Model\nmodule.exports = mongoose.model('User', User);\n\n\n// WEBPACK FOOTER //\n// ./models/User.js"],"sourceRoot":""}